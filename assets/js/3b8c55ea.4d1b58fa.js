"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[803],{23:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"installation","title":"Installation","description":"This section outlines how to install and do basic configuration of","source":"@site/docs/installation.md","sourceDirName":".","slug":"/installation","permalink":"/docs/installation","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/installation.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Installation","sidebar_position":2,"sidebar_label":"Installation"},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/docs/"},"next":{"title":"Configuration","permalink":"/docs/configuration"}}');var i=t(4848),a=t(8453);const l={title:"Installation",sidebar_position:2,sidebar_label:"Installation"},o="Installation",r={},c=[{value:"Setup and Configure MySQL Database Server",id:"setup-and-configure-mysql-database-server",level:2},{value:"Install Database Packages",id:"install-database-packages",level:3},{value:"Database Configuration",id:"database-configuration",level:3},{value:"Install Prerequisite Supporting Operating System Packages",id:"install-prerequisite-supporting-operating-system-packages",level:2},{value:"Ubuntu / Debian / Mint",id:"ubuntu--debian--mint",level:3},{value:"Centos / Fedora",id:"centos--fedora",level:3},{value:"Install Switchmap-NG",id:"install-switchmap-ng",level:2},{value:"Clone the Repository",id:"clone-the-repository",level:3},{value:"Install Prerequisite Python Packages",id:"install-prerequisite-python-packages",level:3},{value:"Edit The Configuration File",id:"edit-the-configuration-file",level:3},{value:"Run Installation Script",id:"run-installation-script",level:3},{value:"Testing Installation",id:"testing-installation",level:2},{value:"Testing Polling",id:"testing-polling",level:3},{value:"Testing the API Server",id:"testing-the-api-server",level:3},{value:"Testing the Web Dashboard",id:"testing-the-web-dashboard",level:3},{value:"Testing Setup for Developers",id:"testing-setup-for-developers",level:2},{value:"Database Configuration",id:"database-configuration-1",level:3},{value:"Setup the Test Config File",id:"setup-the-test-config-file",level:3},{value:"Run the Test Suite",id:"run-the-test-suite",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"installation",children:"Installation"})}),"\n",(0,i.jsxs)(n.p,{children:["This section outlines how to install and do basic configuration of\n",(0,i.jsx)(n.code,{children:"switchmap-ng"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"setup-and-configure-mysql-database-server",children:"Setup and Configure MySQL Database Server"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"switchmap-ng"})," uses a MySQL database to store data. This section\noutlines how to set it up."]}),"\n",(0,i.jsx)(n.h3,{id:"install-database-packages",children:"Install Database Packages"}),"\n",(0,i.jsx)(n.p,{children:"Install MySQL on a database server as outlined in the MySQL\ndocumentation."}),"\n",(0,i.jsx)(n.h3,{id:"database-configuration",children:"Database Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Create the database, and grant privileges to a switchmap user. In this\ncase both the database and the database user are named ",(0,i.jsx)(n.code,{children:"switchmap"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ sudo mysql\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE DATABASE switchmap;\nGRANT ALL PRIVILEGES ON switchmap.* TO 'switchmap'@'localhost' IDENTIFIED BY 'CHANGE_ME_NOW';\nFLUSH PRIVILEGES;\nEXIT;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"install-prerequisite-supporting-operating-system-packages",children:"Install Prerequisite Supporting Operating System Packages"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"switchmap-ng"})," has the following requirements:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"python >= 3.5"}),"\n",(0,i.jsx)(n.li,{children:"python3-pip"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"It will not work with lower versions."}),"\n",(0,i.jsx)(n.h3,{id:"ubuntu--debian--mint",children:"Ubuntu / Debian / Mint"}),"\n",(0,i.jsx)(n.p,{children:"The commands for installing the dependencies are:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ sudo apt-get -y install python3 python3-pip snmp libsnmp-dev snmp-mibs-downloader gcc python-dev-is-python3 python3-venv\n"})}),"\n",(0,i.jsx)(n.h3,{id:"centos--fedora",children:"Centos / Fedora"}),"\n",(0,i.jsx)(n.p,{children:"The commands for installing the dependencies are:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ sudo dnf -y install python3 python3-pip net-snmp-utils net-snmp-devel gcc python-devel python3-virtualenv\n"})}),"\n",(0,i.jsx)(n.h2,{id:"install-switchmap-ng",children:"Install Switchmap-NG"}),"\n",(0,i.jsx)(n.p,{children:"Installation is simple. Follow these steps"}),"\n",(0,i.jsx)(n.h3,{id:"clone-the-repository",children:"Clone the Repository"}),"\n",(0,i.jsx)(n.p,{children:"Now clone the repository and copy the sample configuration file to its\nfinal location."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ git clone https://github.com/PalisadoesFoundation/switchmap-ng\n$ cd switchmap-ng\n"})}),"\n",(0,i.jsx)(n.h3,{id:"install-prerequisite-python-packages",children:"Install Prerequisite Python Packages"}),"\n",(0,i.jsxs)(n.p,{children:["To ensure that switchmap will be using only the versions of python\npackages it requires, independent of any other python applications you\nmay have installed, even after a operating system upgrade, we use the\npython ",(0,i.jsx)(n.code,{children:"venv"})," system."]}),"\n",(0,i.jsxs)(n.p,{children:["In short, venv makes ",(0,i.jsx)(n.code,{children:"switchmap-ng"})," work in a more predictable way which\nimproves reliability and simplifies troubleshooting."]}),"\n",(0,i.jsx)(n.p,{children:"The following commands will:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["create a directory named ",(0,i.jsx)(n.code,{children:"venv/"})," in the top most ",(0,i.jsx)(n.code,{children:"switchmap-ng"}),"\ndirectory."]}),"\n",(0,i.jsx)(n.li,{children:"copy your systems python files there"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Here are the commands:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ cd /path/to/switchmap-ng\n$ python3 -m venv venv\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You will now need to activate the use of these copied python files by\n",(0,i.jsx)(n.code,{children:"switchmap-ng"}),"."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["This can be done using the ",(0,i.jsx)(n.code,{children:"source"})," command referencing a script\nthat will do the activation."]}),"\n",(0,i.jsxs)(n.li,{children:["Your command prompt will change to have a ",(0,i.jsx)(n.code,{children:"(venv)"})," prefix"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Here are the commands:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ source venv/bin/activate\n(venv) $ \n"})}),"\n",(0,i.jsxs)(n.p,{children:["Now you can install the extra python packages using ",(0,i.jsx)(n.code,{children:"pip3"})," referencing\nthe packages in the ",(0,i.jsx)(n.code,{children:"requirements.txt"})," file"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ pip3 install -r requirements.txt\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Remember to always be in ",(0,i.jsx)(n.code,{children:"venv"})," mode when running ",(0,i.jsx)(n.code,{children:"switchmap-ng"})," by\nrunning the source command first. You only need to run the command once\nper terminal session."]}),"\n",(0,i.jsx)(n.h3,{id:"edit-the-configuration-file",children:"Edit The Configuration File"}),"\n",(0,i.jsxs)(n.p,{children:["Please read the ",(0,i.jsx)(n.code,{children:"configuration"})," file\nbeforehand before proceeding."]}),"\n",(0,i.jsxs)(n.p,{children:["Edit your configuration file with the appropriate configuration options.\nHere are the steps using the ",(0,i.jsx)(n.code,{children:"vim"})," editor:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ cp examples/etc/config.yaml etc/config.yaml\n(venv) $ vim etc/config.yaml\n"})}),"\n",(0,i.jsx)(n.p,{children:"Make the required changes."}),"\n",(0,i.jsx)(n.h3,{id:"run-installation-script",children:"Run Installation Script"}),"\n",(0,i.jsx)(n.p,{children:"You will now need to run the database installation script. This creates\nthe database tables and populates some of them with important data."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ bin/tools/create_db_tables.py\n"})}),"\n",(0,i.jsx)(n.h2,{id:"testing-installation",children:"Testing Installation"}),"\n",(0,i.jsxs)(n.p,{children:["There are a number of ways to test your installation. Please refer to\nthe ",(0,i.jsx)(n.code,{children:"troubleshooting"})," guide for additional\ndetails if these methods fail."]}),"\n",(0,i.jsx)(n.h3,{id:"testing-polling",children:"Testing Polling"}),"\n",(0,i.jsxs)(n.p,{children:["You can test your SNMP configuration and connectivity to your devices\nusing the ",(0,i.jsx)(n.code,{children:"switchmap_poller_test.py"})," utility like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ bin/tools/switchmap_poller_test.py --hostname HOSTNAME\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If you have setup switchmap-ng as a system daemon with a\n",(0,i.jsx)(n.code,{children:"daemon_directory:"})," value ",(0,i.jsx)(n.code,{children:"/var/run"})," you will need to specify the ",(0,i.jsx)(n.code,{children:"venv"}),"\npath to ",(0,i.jsx)(n.code,{children:"python3"})," first."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ sudo venv/bin/python3 bin/tools/switchmap_poller_test.py --hostname HOSTNAME\n"})}),"\n",(0,i.jsx)(n.p,{children:"If successful it will print the entire contents of the polled data on\nthe screen."}),"\n",(0,i.jsx)(n.h3,{id:"testing-the-api-server",children:"Testing the API Server"}),"\n",(0,i.jsx)(n.p,{children:"You can test whether the API is working by starting it on the device\ndesignated to receiving polling information and storing it in the\ndatabase."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ bin/systemd/switchmap_server --start\n(venv) $ bin/systemd/switchmap_server --status\n"})}),"\n",(0,i.jsx)(n.p,{children:"The result of the status check should look like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Daemon is running - <bound method Agent.name of <switchmap.core.agent.AgentAPI object at>>\nDaemon is running - <bound method Agent.name of <switchmap.core.agent.Agent object at>>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"testing-the-web-dashboard",children:"Testing the Web Dashboard"}),"\n",(0,i.jsx)(n.p,{children:"You can test whether the web dashboard API is working by"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Correctly configuring and starting the API server as shown above"}),"\n",(0,i.jsx)(n.li,{children:"Starting the web dashboard as shown below."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ bin/systemd/switchmap_dashboard --start\n(venv) $ bin/systemd/switchmap_dashboard --status\n"})}),"\n",(0,i.jsx)(n.p,{children:"The result of the status check should look like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Daemon is running - <bound method Agent.name of <switchmap.core.agent.AgentAPI object at>>\nDaemon is running - <bound method Agent.name of <switchmap.core.agent.Agent object at>>\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can then visit the dashboard URL. (You will need to make adjustments\nif you installed the application on a remote server):"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://localhost:7001/switchmap/",children:"http://localhost:7001/switchmap/"})}),"\n",(0,i.jsx)(n.p,{children:"The Webserver help page provides the necessary steps to view switchmap\non port 80 using Apache or Nginx"}),"\n",(0,i.jsx)(n.h2,{id:"testing-setup-for-developers",children:"Testing Setup for Developers"}),"\n",(0,i.jsx)(n.p,{children:"Follow the installation steps above to have the application ready, then\nadd these steps for developing code."}),"\n",(0,i.jsx)(n.h3,{id:"database-configuration-1",children:"Database Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Create the ",(0,i.jsx)(n.code,{children:"switchmap_unittest"})," database, and grant privileges to a\n",(0,i.jsx)(n.code,{children:"switchmap_unittest"})," user with the password ",(0,i.jsx)(n.code,{children:"switchmap_unittest"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ sudo mysql\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE DATABASE switchmap_unittest;\nGRANT ALL PRIVILEGES ON switchmap_unittest.* TO 'switchmap_unittest'@'localhost' IDENTIFIED BY 'switchmap_unittest';\nFLUSH PRIVILEGES;\nEXIT;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"setup-the-test-config-file",children:"Setup the Test Config File"}),"\n",(0,i.jsxs)(n.p,{children:["Create the testing configuration file which will be stored in a hidden\ndirectory in ",(0,i.jsx)(n.code,{children:"$HOME"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"(venv) $ tests/bin/test_db_config_setup.py\n"})}),"\n",(0,i.jsx)(n.h3,{id:"run-the-test-suite",children:"Run the Test Suite"}),"\n",(0,i.jsx)(n.p,{children:"You can run all the tests with this command."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"(venv) $ tests/bin/_do_all_tests.py\n"})}),"\n",(0,i.jsx)(n.p,{children:"An alternative method is to use pytest."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"(venv) $ pytest tests/switchmap_\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can run individual tests with this command."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"(venv) $ tests/switchmap_/path/to/test.py\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>o});var s=t(6540);const i={},a=s.createContext(i);function l(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);